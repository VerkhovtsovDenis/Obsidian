Уязвимость, эксплуатируемая при взломе данной машины, — **небезопасная конфигурация FTP-сервера, позволяющая анонимный доступ к конфиденциальным данным**, и последующее использование этих данных для несанкционированного доступа к веб-приложению через подбор учетных данных.

### Детали эксплуатации:

1. **Анонимный доступ к FTP (CVE-2020-...)**:
    
    - FTP-сервер (vsftpd 3.0.3) настроен на разрешение анонимного входа (`Anonymous FTP login allowed`). Это позволяет злоумышленнику подключиться без аутентификации и получить доступ к файлам `allowed.userlist` и `allowed.userlist.passwd`, содержащим логины и пароли.
        
2. **Утечка учетных данных**:
    
    - Файлы `allowed.userlist` и `allowed.userlist.passwd` содержат списки пользователей и паролей, которые не должны быть общедоступными. Это указывает на ошибку в защите данных (неправильные права доступа к файлам или их размещение в публичной директории).
        
3. **Подбор учетных данных для веб-приложения**:
    
    - Обнаруженная страница `/login.php` (через сканирование директорий с помощью Gobuster) становится целью для атаки. Используя логины и пароли из файлов FTP, злоумышленник вручную подбирает валидные учетные данные (например, `admin` и `rKXM59E5xesUFHAd`), что приводит к успешному входу в административную панель.
        
4. **Получение флага**:
    
    - После входа в админ-панель флаг отображается напрямую, что также может указывать на недостатки в защите интерфейса (например, отсутствие проверки прав доступа для критических данных).
        

### Рекомендации по устранению:

1. **Запретить анонимный доступ на FTP-сервере**:
    
    - Настроить vsftpd на запрет анонимных подключений (параметр `anonymous_enable=NO` в конфигурационном файле).
        
2. **Защитить конфиденциальные данные**:
    
    - Удалить или ограничить доступ к файлам с учетными данными. Использовать механизмы шифрования или хранения паролей в хешированном виде.
        
3. **Усилить аутентификацию веб-приложения**:
    
    - Внедрить защиту от brute-force (например, капчу, блокировку после нескольких неудачных попыток).
        
    - Использовать многофакторную аутентификацию для админ-панели.
        
4. **Регулярный аудит безопасности**:
    
    - Проверять конфигурации сервисов (FTP, Apache) на наличие уязвимостей.
        
    - Сканировать директории веб-приложения на наличие скрытых ресурсов (вроде `/login.php` или `/dashboard`).
        

Таким образом, основная уязвимость — **неконтролируемый доступ к учетным данным через анонимный FTP**, что позволяет провести атаку на веб-приложение.