Неутомимый студент Стас Басов написал программу, которая считает сумму всех чисел в списке и находит среднее значение этой суммы.

```python
def calculate_sum_and_average(numbers):
    total_sum = 0
    for num in numbers:
        total_sum += num

    average = total_sum // len(numbers)
    return total_sum, average


numbers = [10, 20, 30, 40, 50]
total, avg = calculate_sum_and_average(numbers)
print(f'Сумма чисел: {total}')
print(f'Среднее значение: {avg}')

numbers = [11, 22, 33, 42, 51]
total, avg = calculate_sum_and_average(numbers)
print(f'Сумма чисел: {total}')
print(f'Среднее значение: {avg}') 
```

В зависимости от списка, переданного в аргументы, функция `calculate_sum_and_average()` иногда возвращает правильный результат, а иногда — ошибочный:

```bash
# Для списка [10, 20, 30, 40, 50]:
Сумма чисел: 150      # Проверим вручную: 
                      # 10 + 20 + 30 + 40 + 50 == 150
Среднее значение: 30  # Проверим вручную:
                      # (10 + 20 + 30 + 40 + 50) / 5 == 30

# Для списка [11, 22, 33, 42, 51]:
Сумма чисел: 159      # Проверим вручную: 
                      # 11 + 22 + 33 + 42 + 51 == 159 Всё верно
Среднее значение: 31  # Проверим вручную:
                      # (11 + 22 + 33 + 42 + 51) / 5 == 31.8  Функция ошиблась! 
```

Где-то в программе прячется ошибка!

> [!faq] Ошибка какого типа допущена в приведённой программе?
>> [!fail] Синтаксическая
> Нет, при синтаксической ошибке эта программа просто не запустилась бы. При старте в консоли появилось бы сообщение `SyntaxError: ...`.
>
>> [!fail] Runtime Errors
>
>> [!done] Логическая
>
>> [!fail] Ошибка форматирования
>
>> [!fail] Ошибка в типизации
>
>> [!fail] Ошибка эволюции
>
>> [!fail] Педагогическая ошибка

Ошибку в программе нужно найти и обезвредить! В этом деле поможет **отладчик**, встроенный в VS Code.

## Отладчик VS Code

Откройте редактор кода, создайте новый файл, например _average.py_, и скопируйте в него код из листинга.

![На скриншоте — интерфейс VSCode с кодом из листинга.](https://pictures.s3.yandex.net/resources/image_1702056759.png)

Запустите программу кнопкой-стрелкой в верхней правой части интерфейса, убедитесь, что программа работает.

Код выполняется построчно; на каждом этапе программа выполняет определённые инструкции, а переменные принимают какие-то значения.

При создании программы разработчик держит состояние программы в голове, но очень часто требуется увидеть состояние программы на том или ином шаге выполнения. Для контроля происходящего можно применить функцию `print()` — например, чтобы увидеть, что вернула функция или что происходит в цикле. Но невозможно набить всю программу строчками с `print()` — придётся постоянно добавлять и удалять строки с выводом, это непрактично.

**Отладчик кода** позволяет построчно отслеживать состояние программы и на каждом шаге наблюдать за вызовами функций и значениями переменных.

В редакторе VS Code есть встроенный отладчик, откройте его: в левой боковой панели выберите пункт _Run and Debug_. Слева появится вкладка **Run and Debug** и кнопка запуска — не спешите нажимать её, сперва нужно настроить работу отладчика.

![На скриншоте — интерфейс VS Code.](https://pictures.s3.yandex.net/resources/image_1702056779.png)

Как правило, при отладке кода разработчика интересует определённый фрагмент программы. В режиме отладки можно установить отметку в начале нужного фрагмента — и программа приостановит работу на указанной строке. Такие отметки называются **breakpoint** — «брейкпоинт», точка останова.

Когда программа останавливается, разработчик может изучить текущее состояние программы, значения переменных и многое другое.

Кликните слева от номера любой строки кода. Появится красная точка, символизирующая точку останова. Второй клик удалит существующую точку.

Программа делает ошибки при вычислении значения `average`, это значение вычисляется на строке 6. Именно эти вычисления и нужно проверить, а значит, брейкпоинт нужно установить на шестой строке.

![На скриншоте — интерфейс VS Code: брейкпоинт установлен на шестой строке — average = total_sum // len(numbers).](https://pictures.s3.yandex.net/resources/image_1702056789.png)

Запустите отладчик: нажмите кнопку **Run and Debug**. VS Code попросит вас выбрать конфигурацию отладки, выбирайте «Файл Python» (Python File):

![На скриншоте — интерфейс VSCode: варианты конфигурации отладки перечислены в выпадающем меню.](https://pictures.s3.yandex.net/resources/image_1702056803.png)

Окно редактора кода изменится; программа начнёт выполняться и остановится на брейкпоинте:

![На скриншоте — интерфейс VSCode после запуска отладчика. Слева, рядом с боковым меню, — «Debug-панель», область с кодом — «Рабочая область», над областью с кодом — Debug Toolbar, область терминала — «Терминал в режиме отладки».](https://pictures.s3.yandex.net/resources/image_1702056812.png)

Окно VS Code в режиме отладки делится на четыре части:

1. Боковая Debug-панель с информационным меню.
2. _Debug Toolbar_ — панель с кнопками управления процессом отладки:
    - _Continue_ (F5) — «продолжить». Продолжение выполнения программы до следующего брейкпоинта или до конца.
    - _Step over_ (F10) — «переступить». Если на текущей строке есть вызов пользовательской функции — выполнить её как единую команду, не останавливая выполнение на каждой строке этой функции, «не заглядывая внутрь». В остальных случаях — перейти к следующей строке кода.
    - _Step into_ (F11) — «войти». Если на текущей строке есть вызов пользовательской функции — войти в неё и проследить за её выполнением построчно. В остальных случаях — перейти к следующей строке кода.
    - _Step out_ (Shift+F11) — «выйти». Находясь внутри пользовательской функции — выполнить оставшиеся строки этой функции без остановок, как если бы это была одна команда и вернуться к предыдущему контексту выполнения (к тому месту в коде, откуда была вызвана эта функция).
    - _Restart_ (Shift+Ctrl+F5) — «перезапустить отладчик».
    - _Stop_ (Shift+F5) — «остановить отладку».
3. Рабочая область с кодом. Здесь появился указатель, который останавливается на той строке, которую Python обрабатывает в текущий момент.
4. Терминал, запущенный в режиме отладки.

Когда исполнение программы остановится на строке 6, можно посмотреть и проанализировать значения переменных. В рабочей области с кодом эта строка отмечена специальным значком:

![На скриншоте — интерфейс VSCode с частью кода, в которой специальным значком выделена шестая строка. Это строка, на которой остановилось выполнение программы. Код в этой строке: average = total_sum // len(numbers).](https://pictures.s3.yandex.net/resources/image_1702056822.png)

В разделе **Variables** боковой Debug-панели отображаются значения переменных на текущем этапе выполнения программы. На экране видны все значения списка `numbers` и вычисленная сумма этих элементов на момент остановки. Ошибки нет, сумма посчитана верно.

Продолжайте выполнять программу по шагам, нажимая кнопку **Step into** в Debug Toolbar. На следующем шаге в разделе **Variables** появится ещё одна переменная — `average`, её значение тоже рассчитано верно.

![На скриншоте — интерфейс VS Code. Брейкпоинт — на шестой строке average = total_sum // len(numbers); строка, на которой остановилось выполнение программы — седьмая, return total_sum, average. На Debug-панели в разделе Variables — информация о переменной  average: ‘average: 30’.](https://pictures.s3.yandex.net/resources/image_1702056840.png)

Делайте шаги **Step into** до тех пор, пока выполнение кода вновь не дойдёт до шестой строки кода_._

![На скриншоте — интерфейс VS Code. Брейкпоинт установлен на шестой строке кода. На этой же строке остановилось выполнение программы.](https://pictures.s3.yandex.net/resources/image_1702056848.png)

Второй набор данных отобразился в разделе **Variables**. Сумма элементов вновь посчитана верно. Сделайте ещё один шаг вперёд.

![На скриншоте — интерфейс VS Code. Брейкпоинт — на шестой строке average = total_sum // len(numbers); строка, на которой остановилось выполнение программы — седьмая, return total_sum, average.](https://pictures.s3.yandex.net/resources/image_1702056860.png)

И вот она, ошибка: деление суммы элементов на их количество дало неправильный результат — вместо `31.8` выражение вернуло `31`.

Всему виной опечатка: вместо оператора деления `/` применён оператор целочисленного деления `//`. Исправьте ошибку: замените оператор целочисленного деления на `/`.

Теперь код в полном порядке, однако для того, чтобы программа «восприняла» изменения — отладчик надо перезапустить.

Дело в том, что при старте отладчик «запоминает» состояние программы, и все изменения, внесённые после старта отладчика, игнорируются. При перезапуске отладчика все изменения будут учтены.

Выйдите из режима отладки, нажав на кнопку **Stop**, запустите программу ещё раз и убедитесь в этом.

![На скриншоте — интерфейс VSCode. Режим отладки выключен.](https://pictures.s3.yandex.net/resources/image_1702056867.png)

Охота на баги — древнее и уважаемое в среде разработчиков искусство. Арсенал охотников велик, и отладчик — один из традиционных и популярных инструментов в этом арсенале. Умелое обращение с ним приходит с опытом, любая тренировка пойдёт на пользу. Счастливой охоты!