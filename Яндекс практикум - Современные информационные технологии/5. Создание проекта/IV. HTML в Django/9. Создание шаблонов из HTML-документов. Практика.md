# Создание шаблонов из HTML-документов. Практика

### Как сделать пункты меню активными

Пользователь должен понимать, в каком разделе сайта он находится. Для этого текущий пункт меню «подсвечивают» — например, выделяют его цветом. В коде это обычно реализуют так: к нужному элементу добавляют класс `active` и свойства этого класса описывают в CSS.

В Bootstrap необходимые стили уже описаны, так что можно просто указать нужный класс.

Вот так можно подсветить пункт меню «Главная»:

```html
<li class="nav-item">
  <a class="nav-link active" href="{% url 'homepage:index' %}">Главная</a>
</li> 
```

Bootstrap увидит класс `active` и подсветит ссылку:

![](https://pictures.s3.yandex.net/resources/S01_138_1677516687.png)

Но навигация сохранена в отдельном шаблоне и подключена через `{{% include %}}`; значит, один и тот же шаблон с навигацией будет применён и для главной страницы, и для всех остальных. Как узнать, какой пункт меню подсвечивать?

Django [позволяет узнать имя view-функции](https://docs.djangoproject.com/en/3.2/ref/urlresolvers/#django.urls.ResolverMatch), которая вызвала текущий шаблон. Это имя доступно в переменной шаблона `{{ request.resolver_match.view_name }}`.

Чтобы решить, подсвечивать пункт меню или нет, достаточно выполнить проверку: если адрес view-функции, вызвавшей шаблон, совпадёт с `homepage:index`, то в тег `<a>` нужно дописать класс `active`.

```django
<li class="nav-item">
  <a class="nav-link     
     {% if request.resolver_match.view_name  == 'homepage:index' %}
       active
     {% endif %}"
     href="{% url 'homepage:index' %}">
     Главная
  </a>
</li> 
```

Если проводить такую проверку в каждом пункте меню, код будет громоздким. Сократить его поможет тег шаблонов `{% with ... as ... %}`. Этот тег позволяет для любого выражения создать короткий синоним: `{% with очень_длинное_выражение as синоним %}`; этот синоним можно применять до закрывающего тега `{% endwith %}`.

В области действия тега `{% with %}` имя `view_name` будет применяться вместо выражения `request.resolver_match.view_name`:

```django
<!-- Создаём синоним для выражения request.resolver_match.view_name -->
{% with request.resolver_match.view_name as view_name %}
...
<li class="nav-item">
  <a class="nav-link {% if view_name  == 'homepage:index' %}active{% endif %}"
     href="{% url 'homepage:index' %}">
     Главная
  </a>
</li>
...
{% endwith %} 
```

### Задание

Проект «Анфиса для друзей», который в прошлом уроке вы развернули на своём компьютере, содержит несколько страниц. К проекту уже подключены шаблоны, они разбиты на логические блоки; файлы, из которых рендерится шаблон, лежат в каталоге _anfisa_for_friends/templates_.

```
Dev/
 └── anfisa1sprint/
     ├── anfisa_for_friends/
           ├── ...
           ├── static_dev/         <--- Тут лежит подключённая статика
           ├── templates/          <--- Тут лежат подключённые шаблоны
           ├── ...
     ├── html_templates/           <--- Тут лежит новая вёрстка и статика
     ├── .gitignore
     ├── LICENSE
     ├── README.md
     └── requirements.txt 
```

В директории _anfisa1sprint/html_templates_ лежат HTML-файлы с новой вёрсткой для страниц проекта, а также необходимая для них статика — файлы картинок, CSS и JS.

Ваша задача — обновить шаблоны проекта, используя новую вёрстку.

### Порядок выполнения задания:

1. В новых HTML-файлах комментариями отмечены границы блоков, по которым нужно разделить код на шаблоны. Перенесите код в соответствующие файлы:
    - в _base.html_,
    - в файлы _header.html_ и _footer.html,_
    - в файлы, подключаемые через `{% include %}`. Если какой-то фрагмент HTML-кода встречается больше двух раз, выносите этот фрагмент в отдельный файл и включайте его в основной код через `{% include %}`.
2. Обновите содержимое шаблонов _index.html,_ _description.html, list.html_ и _detail.html:_
    - они по-прежнему должны расширять базовый шаблон _base.html,_
    - в HTML-файлах с новой вёрсткой комментариями отмечены границы блоков `title` и `content`; в этих файлах вы найдёте обновлённое содержимое блоков.
3. Обновите содержимое директории _static_dev_: для работы проекта понадобятся новые картинки и новая статика из каталога _html_templates_.
4. В файлах _base.html_ и _header.html_ проверьте и, при необходимости, обновите адреса подключения файлов статики, а также ссылки на страницы.
5. Настройте шаблоны так, чтобы ссылка на просматриваемую страницу была всегда «подсвечена» в меню сайта.

Запустите проект и убедитесь, что всё работает. Если задание выполнено правильно, то страницы будут выглядеть так: