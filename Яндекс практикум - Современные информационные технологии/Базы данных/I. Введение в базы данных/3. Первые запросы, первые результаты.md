# Первые запросы, первые результаты

В этом и в дальнейших уроках мы будем работать с **СУБД SQLite** — это «лёгкая» СУБД, она не требует сложной настройки, хранит все данные в одном файле, потребляет мало ресурсов и удобна при разработке проектов.

> Если SQL — это «эс-кью-эл», то SQLite — это «эс-кью-лайт».

Для работы с базой данных нужно:

- через терминал или специальную программу установить соединение с базой;
- через терминал или программу отправить нужные SQL-запросы.

Начнём прямо сейчас: поработаем с SQLite через командную строку. Первым делом нужно установить оболочку SQLite на рабочий компьютер.

### Установка SQLite

macOS

В **macOS** для установки модуля sqlite ничего делать не нужно. Он предустановлен во всех современных версиях этой операционной системы.

Если потребуется обновить версию SQLite, то сделать это можно через Homebrew.
```bash
brew update && brew install sqlite3 
```

Linux

В **Linux** sqlite3 также установлен по умолчанию. Но можно обновить его. Откройте терминал (горячие клавиши Ctrl+Alt+T) и выполните команду обновления (код показан на примере Ubuntu):
```bash
sudo apt update && sudo apt install sqlite3 
```

Windows

Скачайте и установите дистрибутив с официального сайта: [https://www.sqlite.org/download.html](https://www.sqlite.org/download.html)

Вам понадобится архив с именем sqlite-tools-win-x64-XXXXXXX.zip:

![](https://pictures.s3.yandex.net/resources/image_1710781961.png)

Создайте папку `C:\sqlite` и разархивируйте в неё скачанные файлы.

![](https://pictures.s3.yandex.net/resources/S2_1271_1678192494.png)

Чтобы запускать sqlite из командной строки — добавьте путь `C:\sqlite` в переменную среды `PATH`.

Для этого:

- перейдите в Этот компьютер → Свойства → Дополнительно → Переменные среды либо в строке поиска Windows введите слово _path_ и откройте окно настроек переменных среды из результатов поиска.
- в списке найдите переменную `PATH`, выделите её, нажмите кнопку **Изменить**, в открывшемся окне нажмите **Создать** и добавьте новый путь.

![](https://pictures.s3.yandex.net/resources/S2_132_1685546476.png)

Если в списке нет переменной Path — в окне «Переменные среды» нажмите кнопку **Создать**, в появившемся окне создайте новую запись.

![](https://pictures.s3.yandex.net/resources/S2_1266_1685546497.png)

После внесения изменений перезагрузите компьютер.

## Запуск sqlite из командной строки

Введите в терминал команду `sqlite3` (или `winpty sqlite3` если работаете через Git Bash под Windows); появится ответ (в зависимости от операционной системы текст ответа может отличаться, но это не повлияет на работу):

![](https://pictures.s3.yandex.net/resources/S3.2_09_1691840142.png)

Запустилась оболочка **sqlite, и она** готова к приёму SQL-запросов.

При выполнении команды `sqlite3`

- была создана «виртуальная база» в памяти компьютера;
- оболочка **sqlite** подключилась к этой базе и готова работать с ней;
- по окончании работы база будет стёрта.

Удобный вариант для экспериментов.

## Поговорим с базой на её языке

Выполним типичные операции с БД:

- создадим таблицу в БД,
- заполним таблицу данными,
- запросим содержимое этой таблицы.

Для начала создадим в пустой базе данных таблицу и добавим в неё пару записей

Запросы вводите построчно, каждый запрос по очереди отправляйте нажатием на Enter.

```SQL
CREATE TABLE video_products (title TEXT, release_year INTEGER);
-- СОЗДАТЬ ТАБЛИЦУ video_products со столбцами(title TEXT, release_year INTEGER);

-- Создаём запись в таблице video_products:
INSERT INTO video_products VALUES('Весёлые мелодии', 1930);
-- ВСТАВИТЬ В таблицу video_products ЗНАЧЕНИЯ('Весёлые мелодии', 1930);

-- Создаём ещё одну запись в таблице video_products:
INSERT INTO video_products VALUES('Кто подставил кролика Роджера', 1988);
-- ВСТАВИТЬ В таблицу video_products ЗНАЧЕНИЯ('Кто подставил кролика Роджера', 1988); 
```

![](https://pictures.s3.yandex.net/resources/S2_135_1691840156.png)

В результате этих запросов

- в базе данных создана таблица **video_products** с двумя столбцами — `title` и `release_year`;
- в таблице созданы две записи.

Таблица выглядит так:

![](https://pictures.s3.yandex.net/resources/S2_135_1_1682533217.png)

> Язык запросов — регистронезависимый, то есть команда `create table video_products (title text, release_year INTEGER);` тоже создаст таблицу. Но при таком стиле оформления плохо видно, где команды, а где сущности из базы, с которыми происходит работа.

Теперь из таблицы **video_products** можно **получить** данные. При экспериментах в консоли ответ будет выведен прямо в консоль, а вот если запрос к БД отправлен из Python-приложения — то данные, полученные из БД, могут быть обработаны программой и, например, отображены на веб-странице.

```SQL
SELECT * FROM video_products;
-- ВЕРНУТЬ все поля (символ * означает "все") записей ИЗ таблицы video_products. 
```

В ответ на запрос в терминал вернутся данные из базы:

```SQL
Весёлые мелодии|1930
Кто подставил кролика Роджера|1988 
```

Можно сделать запрос и посложнее:

```SQL
SELECT title FROM video_products WHERE release_year = 1930;
-- ВЕРНУТЬ значения поля title ИЗ таблицы video_products
-- тех записей, ГДЕ значение поля release_year равно 1930. 
```

В ответе будет только содержимое поля `title` той записи, которая удовлетворяет условию `WHERE`:

```bash
Весёлые мелодии 
```

Чтобы выйти из оболочки sqlite3, можно выполнить команду `.exit` или просто закрыть окно терминала. Виртуальная база перестанет существовать.

Точно так же можно взаимодействовать и с реальной базой, которая хранится на жёстком диске сервера или вашего компьютера. Для этого при вызове утилиты **sqlite3** нужно указать имя файла с базой данных, например, вот так:

```bash
 sqlite3 db.sqlite 
```

### Настройка VS Code для просмотра файлов SQLite

[Скачайте файл](https://code.s3.yandex.net/backend-developer/learning-materials/db_video.sqlite) с базой данных: в ней сохранена информация о нескольких фильмах.

В базу хочется заглянуть, но нельзя просто взять и открыть файл _.sqlite_: большинство операционных систем по умолчанию ничего не знает о таких файлах.

![](https://pictures.s3.yandex.net/resources/S3.2_011_1678059033.png)

Можно попробовать открыть файл в VS Code, но и он по умолчанию выдаст ошибку.

![](https://pictures.s3.yandex.net/resources/S3.2_121_1678192566.png)

Но огорчаться совсем не кстати: в VS Code можно установить расширение, которое позволит открыть файл с базой данных прямо в редакторе.

Нажмите горячие клавиши Ctrl+Shift+X (Cmd+Shift+X в macOS), в появившемся окне поиска вбейте _sqlite_ и выберите расширение _SQLite Viewer_. Нажмите на кнопку _Install_ — и программа сама установит расширение.

![](https://pictures.s3.yandex.net/resources/S3.2_131_1678192581.png)

Готово? Теперь в VS Code можно просматривать файлы _.sqlite_:

![](https://pictures.s3.yandex.net/resources/S3.2_141_1678192601.png)

### Эксперимент

Через терминал перейдите в ту директорию, где сохранена база _db_video.sqlite_ и подключитесь к этой базе: выполните команду `sqlite3 db_video.sqlite`. Затем добавьте в базу данных запись о ещё каком-нибудь фильме.

Примеры запросов есть в уроке, попробуйте! Результат теперь можно сразу же проверить через VS Code.

> В следующих уроках не забывайте тестировать код из листингов «на столе», через терминал. Тут-то вам и пригодится SQLite Viewer!