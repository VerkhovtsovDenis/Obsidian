Управлять сайтами через консоль не очень удобно. Когда проект будет готов и передан заказчику — управлять проектом будет, скорее всего, не программист, а кто-то из менеджеров. Заставлять его работать с проектом через консоль негуманно: вполне вероятно, что этот инструмент ему незнаком.

Администратору сайта лучше дать другой способ управления. Например, в Django есть встроенное приложение `django.contrib.admin`. Оно создаёт графический веб-интерфейс, который позволяет добавлять, удалять или изменять данные. Этот интерфейс называют «административная зона», «админ-зона» или просто «админка».

Разумеется, доступ к админ-зоне должен быть только у администратора сайта: нельзя пускать туда всех подряд. Для управления правами пользователя в Django есть другое стандартное приложение: `django.contrib.auth`.

Приложения `django.contrib.admin` и `django.contrib.auth` подключены по умолчанию и становятся доступны сразу после развёртывания проекта.

Итак, ваша задача — настроить интерфейс админки и создать пользователей, которые смогут управлять информацией на сайте.

### Создание суперпользователя

Пользователей с правами superuser (иначе их называют «суперпользователями») можно создать через админ-зону (там есть специальный раздел для управления пользователями). Но первого суперпользователя нужно создать через консоль.

Активируйте виртуальное окружение проекта «Анфиса для друзей» и выполните команду

Скопировать код

BASH

```
python manage.py createsuperuser 
```

После этого система запросит имя для нового пользователя, адрес его почты и пароль:

Скопировать код

BASH

```
# Придумайте логин (например, своё имя на латинице).
Username (leave blank to use 'user'):  
Email address:  # Укажите почту.
Password:  # Придумайте пароль (введённые символы отображаться не будут).
Password (again):  # Повторите пароль.
Superuser created successfully. 
```

Под этой учётной записью вы сможете войти в админку и управлять проектом. Если вы забудете пароль — можно поменять его через консоль `python manage.py changepassword <user_name>`, а можно просто создать нового суперпользователя.

Если вы укажете слишком простой пароль, Django предложит усложнить его:

Скопировать код

BASH

```
Username (leave blank to use 'user'): DjangoAdmin
Email address: admin@admin.com
Password: 
Password (again): 
****The password is too similar to the username.
This password is too short. It must contain at least 8 characters.
This password is too common.
****Bypass password validation and create user anyway? [y/N]:
# Django спрашивает, оставить ли указанный вами пароль, который:
# Слишком похож на имя пользователя.
# Слишком короток.
# Слишком распространён. 
```

«Качество» пароля Django проверяет с помощью валидаторов (англ. _valid —_ это «действительный, имеющий силу, правомерный») — классов или функций, проверяющих данные на соответствие определённым правилам.

По умолчанию, пароль и логин проверяется такими валидаторами:

- `UserAttributeSimilarityValidator`: пароль и имя пользователя не должны быть сходными;
- `MinimumLengthValidator`: длина пароля не должна быть меньше 8 символов;
- `CommonPasswordValidator`: пароль не должен входить в список самых распространённых;
- `NumericPasswordValidator`: пароль не должен состоять только из цифр.

## Добро пожаловать в админ-зону!

Запустите в активированном окружении сайт командой: `python manage.py runserver`

Откройте в браузере страницу авторизации — [http://127.0.0.1:8000/admin/](http://127.0.0.1:8000/admin/)

![](https://pictures.s3.yandex.net/resources/S3.1_02_1679040680.png)

Введите имя и пароль суперпользователя — и вы попадёте в админ-зону сайта:

![](https://pictures.s3.yandex.net/resources/S3.1_03_1679040692.png)

Не нужно создавать суперпользователя _admin_ с паролем _admin_ на работающем в интернете проекте: тогда беды не миновать. Пароль подберут, данные испортят или украдут.

Интерфейс админки сейчас на английском, а для управления доступен только раздел AUTHENTICATION AND AUTHORIZATION — в нём собраны инструменты для управления пользователями. Чтобы в нашем проекте можно было управлять сортами мороженого, категориями и топпингами, в админ-панель нужно добавить модели.

### Добавление моделей в админ-панель

Админ-зона может отображать веб-интерфейсы для управления объектами моделей, но для этого модели должны быть подключены к админ-зоне. Разработчик вручную указывает, какие модели должны управляться через админку — ведь в проекте могут быть и служебные модели, которые не нужны в админ-зоне.

Для отображения в админке модели регистрируются в файлах _<имя_приложения>/admin.py_ Добавим модель `Category` в интерфейс админ-зоны; для этого надо зарегистрировать модель в файле _ice_cream/admin.py_.

Пока что файл _ice_cream/admin.py_ пуст:

Скопировать код

PYTHON

```
# ice_cream/admin.py
from django.contrib import admin

# Register your models here. 
```

Добавьте в него такой код:

Скопировать код

PYTHON

```
# ice_cream/admin.py
from django.contrib import admin

# Из модуля models импортируем модель Category...
from .models import Category

# ...и регистрируем её в админке:
admin.site.register(Category) 
```

Сохраните файл, обновите страницу админки — и в ней появится новый раздел:

![](https://pictures.s3.yandex.net/resources/S3.1_04_1679041065.png)

Django не знает тонкостей языка, поэтому множественное число от _Category_ вместо _Categories_ отображает как _Categorys_. Программа, что с неё взять!

Файлы _admin.py_ размещены в директориях приложений. Интерфейс админ-зоны разделён по приложениям, и каждая модель отображается в разделе того приложения, в _admin.py_ которого она зарегистрирована. При этом сама модель может не принадлежать этому приложению.

Перейдите в раздел **Categorys** админ-зоны: там отображаются созданные в проекте категории; для создания новых категорий есть кнопки **ADD CATEGORY** и **Add**.

![](https://pictures.s3.yandex.net/resources/S3.1_05_1679041082.png)

Нажмите на кнопку **Add** и создайте новую категорию: заполните поля Title и Slug (содержимое для полей придумайте самостоятельно; из содержимого поля Slug в дальнейшем будет генерироваться URL веб-страницы, где будет отображён список сортов мороженого этой категории). В поле Output order можно оставить значение по умолчанию.

В интерфейсе админки названия полей Title, Slug и Output order написаны жирным шрифтом. Это подсказка для администратора: «поля обязательны для заполнения». Если не заполнить эти поля, то при сохранении данных система выдаст сообщение об ошибке.

После заполнения всех полей нажмите кнопку **Save**.

![](https://pictures.s3.yandex.net/resources/S3.1_06_1679041110.png)

После нажатия кнопки **Save** будет вызван метод `Category.objects.create()`, и в него будут переданы значения полей из формы; в результате будет создана новая запись в таблице `ice_cream_category`.

В этом можно удостовериться через редактор кода, открыв файл с базой данных:

![](https://pictures.s3.yandex.net/resources/S3.1_07_1679041123.png)

Новая запись отобразилась и в админке — в виде _Category object (ID)_, где ID — значение поля id этой записи.

![](https://pictures.s3.yandex.net/resources/S3.1_08_1679041136.png)

Проведите эксперимент: запомните id созданной только что записи и удалите её (кликните по её названию; на открывшейся странице будет кнопка для удаления. А можно поставить галочку возле названия и в поле Action выбрать нужное действие). После этого создайте новую запись.

Несмотря на то, что id удалённой записи «свободен» (записи-то нет), новой записи будет присвоен следующий по порядку id.

---

### Задания
#### Задание 1/1

##### Описание задания
Перед началом работы зайдите в админ-зону проекта, запущенного в тренажёре:

- нажмите кнопку «Задеплоить»;
- откройте в новой вкладке ссылку, которая появится в правой верхней части тренажёра;
- допишите к адресу страницы _/admin_ и перейдите по этому адресу;
- авторизуйтесь: логин — _admin_, пароль — _admin_ (безопасность на высоте!).

Осмотрите админку: там пусто и скучно.

Зарегистрируйте модели `Topping`, `Wrapper` и `IceCream` в админ-зоне приложения `ice_cream`.

После выполнения работы задеплойте код и ещё раз осмотрите админку, полюбуйтесь на результаты своей работы

##### Подсказка
Импортируйте нужные модели из _models.py_.

Посмотрите в теории урока, как зарегистрирована модель `Category`, и проделайте то же самое с другими моделями.

##### Решение задания
```python
# ice_cream/admin.py
from django.contrib import admin
from ice_cream.models import Category, Topping, Wrapper, IceCream
  
admin.site.register(Category)
admin.site.register(Wrapper)
admin.site.register(Topping)
admin.site.register(IceCream)
```
Теперь у администратора есть все рычаги управления теми моделями, которые ему нужны. И хотя в Django есть и другие модели — в админке их не видно: нет смысла захламлять интерфейс админ-зоны инструментами, которые не понадобятся администратору.